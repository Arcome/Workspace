import xlrd

def open_excel(file = "events.xlsx"):
    try:
        data = xlrd.open_workbook(file)
        table = data.sheets()[0]
        return table
    except Exception as e:
        print (str(e))

table = open_excel()
weights = [0.0316157543829032, 0.03161400675719036, 0.0315555805231503, 0.022426235870422816, 0.01478143316419894, 0.03160736588335879, 0.03146090356805001, 0.03161481963979693, 0.0316157543829032, 0.0316157543829032, 0.0316157543829032, 0.0316157543829032, 0.03157530997554009, 0.031614410531101915, 0.03129827558358799, 0.031614108657900854, 0.00998872387748911, 0.013270108938041649, 0.013495570668408034, 0.03074984405048236, 0.014325174295576198, 0.03039394737965602, 0.02500416410111701, 0.025508956187082335, 0.0316157543829032, 0.0316157543829032, 0.0316157543829032, 0.0316157543829032, 0.0316157543829032, 0.0316157543829032, 0.03161543530115497, 0.031606338433888125, 0.0316157543829032, 0.0316157543829032, 0.010258725252160383, 0.0316157543829032]
with open("weights.txt",'w') as weightsFile:
    weightsNames = table.row_values(0)
    print(weightsNames)
    del weightsNames[0]
    for i in range(len(weightsNames)):
        weightsFile.write(str(weightsNames[i])+": "+str(weights[i])+'\n')